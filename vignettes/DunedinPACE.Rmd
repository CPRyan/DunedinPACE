---
title: "DunedinPACE: A DNA methylation biomarker of the pace of aging"
author: Vignette created by - Calen P. Ryan, PhD
output:
  BiocStyle::html_document:
    toc: true
vignette: >
  % \VignetteIndexEntry{DunedinPACE: A DNA methylation biomarker of the pace of aging}
  % \VignetteEngine{knitr::rmarkdown}
  % \VignetteEncoding{UTF-8}
---

# `DunedinPACE`

`DunedinPACE` is a novel blood biomarker of the pace of aging for gerontology and geroscience. It shows high test-retest reliability, is associated with morbidity, disability, and mortality, and indicated faster aging in young adults with childhood adversity. DunedinPACE effect-sizes are similar to GrimAge Clock effect-sizes. In analysis of incident morbidity, disability, and mortality, DunedinPACE and added incremental prediction beyond GrimAge.

Click [this link](https://elifesciences.org/articles/73420) to access the original paper describing `DunedinPACE` in more detail.


# Using `DunedinPACE calculator`
```{r}
library(DunedinPACE)
```


The `DunedinPACE` calculator requires a matrix or data.frame of beta values where rownames are probe ids and column names correspond to sample names. Beta values must be numeric and missing values must be coded as 'NA'. 

It should look like this:
```{r}
load("Data/example_betas.Rdata")

# Extract matrix of beta values
beta_matrix <-SummarizedExperiment::assay(example_betas)


```

```{r}
# Dimensions of beta matrix
dim(beta_matrix)

# Head of beta matrix
head(beta_matrix)
```

Once you have your probe list, you can generate the `DunedinPACE` projections as follows:


Output will look like this
```{r}
PoAmProjector(beta_matrix)
```


Note that you will need to have the package `preprocessCore` installed to run DunedinPACE.

The only other argument in the `PoAmProjector()` function is `proportionOfProbesRequired`. This is the threshold for number of probes required to run the function, and is by default set to 0.8. 

# `getRequiredProbes()`

The `getRequiredProbes()` function shows you the core probes used for generating DunedinPACE. Note: In order to calculate `DunedinPACE`, you will need many other probes used in the pre-processing steps prior to `DunedinPACE` selection. 

**Important note: Do __not__ filter your beta matrix using `getRequiredProbes()` prior to using the `PoAmProjector()` function. You will get NAs as output. **

```{r}
getRequiredProbes()
```





